<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- iPhone-friendly viewport (no pinch zoom + supports notch safe area) -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" />
  <title>For You üíñ</title>

  <style>
    html, body {
      overscroll-behavior: none;
    }

    body {
      background-color: #ffe6e6;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;

      /* iPhone-friendly height */
      min-height: 100vh;
      min-height: 100dvh;

      margin: 0;
      text-align: center;
      overflow: hidden;
      position: relative;

      /* Safe area padding for notch/home indicator */
      padding-top: env(safe-area-inset-top);
      padding-bottom: env(safe-area-inset-bottom);

      /* Prevent iOS tap/scroll weirdness */
      touch-action: manipulation;
    }

    h1 {
      color: #ff4d4d;
      font-size: 2.2rem;
      margin: 10px 0 12px;
      position: relative;
      z-index: 2;
      text-shadow: 0 6px 18px rgba(255, 77, 77, 0.18);
      padding: 0 14px;
    }

    .card {
      position: relative;
      z-index: 2;
      background: rgba(255,255,255,0.75);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      border: 1px solid rgba(255,255,255,0.6);
      border-radius: 18px;
      padding: 18px 18px 14px;
      box-shadow: 0 14px 40px rgba(0,0,0,0.12);
      max-width: 420px;
      width: min(92vw, 420px);
    }

    .sub {
      margin: 0 0 12px;
      color: rgba(0,0,0,0.65);
      font-size: 0.98rem;
      line-height: 1.35;
    }

    .gif-container img {
      max-width: 260px;
      width: 70%;
      border-radius: 15px;
      margin: 8px 0 10px;
      box-shadow: 0 12px 35px rgba(0,0,0,0.12);
    }

    .buttons {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
      flex-wrap: wrap;
      position: relative;
      z-index: 2;
      margin-top: 6px;
    }

    button {
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 800;
      transition: all 0.25s ease;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    .primary {
      background-color: #ff4d4d;
      color: white;
      font-size: 1.1rem;
      padding: 12px 18px;
      box-shadow: 0 8px 20px rgba(255, 77, 77, 0.35);
    }

    .primary:hover { background-color: #e60000; transform: translateY(-1px); }
    .primary:active { transform: translateY(0px) scale(0.98); }

    .ghost {
      background-color: #ffffff;
      color: #ff4d4d;
      font-size: 1.05rem;
      padding: 11px 16px;
      border: 1px solid rgba(255,77,77,0.35);
    }

    .ghost:hover { transform: translateY(-1px); }
    .ghost:active { transform: translateY(0px) scale(0.98); }

    #yes-btn {
      background-color: #ff4d4d;
      color: white;
      font-size: 1.5rem;
      padding: 15px 30px;
      box-shadow: 0 4px 15px rgba(255, 77, 77, 0.4);
    }
    #yes-btn:hover { background-color: #e60000; }

    #no-btn {
      background-color: #cccccc;
      color: #333;
      font-size: 1rem;
      padding: 10px 20px;
      box-shadow: 0 3px 12px rgba(0,0,0,0.10);
    }

    /* Screens */
    #game-screen { display: block; }
    #question-screen { display: none; }
    #success-screen { display: none; }

    /* Falling layer */
    .fall-layer {
      position: absolute;
      inset: 0;
      pointer-events: auto; /* changed from none (iOS friendly) */
      z-index: 0;
      overflow: hidden;
    }

    .soft-glow {
      position: absolute;
      inset: -30%;
      background:
        radial-gradient(circle at 30% 20%, rgba(255,255,255,0.55), transparent 40%),
        radial-gradient(circle at 70% 50%, rgba(255,255,255,0.45), transparent 45%);
      z-index: 1;
      pointer-events: none;
    }

    /* Game HUD */
    .hud {
      display: flex;
      justify-content: space-between;
      gap: 12px;
      margin-top: 10px;
      font-weight: 800;
      color: rgba(0,0,0,0.70);
    }

    .pill {
      background: rgba(255,255,255,0.75);
      border: 1px solid rgba(255,255,255,0.65);
      border-radius: 999px;
      padding: 8px 12px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.08);
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    /* Clickable falling items */
    .click-item {
      position: absolute;
      top: -80px;
      pointer-events: auto;
      user-select: none;
      transform: translateY(-120px);
      filter: drop-shadow(0 6px 10px rgba(0,0,0,0.12));
      will-change: transform;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;

      /* Bigger tap target on mobile */
      padding: 10px;

      animation-name: fallDown, sway;
      animation-timing-function: linear, ease-in-out;
      animation-iteration-count: 1, infinite;
    }

    @keyframes fallDown {
      from { transform: translateY(-120px) rotate(0deg); }
      to   { transform: translateY(calc(100dvh + 200px)) rotate(360deg); }
    }

    @keyframes sway {
      0%,100% { margin-left: 0px; }
      50%     { margin-left: 26px; }
    }

    /* Toast */
    .toast {
      position: absolute;
      bottom: calc(18px + env(safe-area-inset-bottom));
      left: 50%;
      transform: translateX(-50%);
      z-index: 5;
      background: rgba(0,0,0,0.70);
      color: white;
      padding: 10px 14px;
      border-radius: 12px;
      font-weight: 700;
      opacity: 0;
      transition: opacity 0.25s ease;
      pointer-events: none;
      max-width: min(92vw, 520px);
    }

    .toast.show { opacity: 1; }

    /* Tiny hearts */
    .heart-pop {
      position: fixed;
      z-index: 6;
      pointer-events: none;
      animation: pop 650ms ease-out forwards;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,0.08));
      transform: translate(-50%, -50%);
    }

    @keyframes pop {
      0% { transform: translate(-50%, -50%) scale(0.6); opacity: 0; }
      15% { opacity: 1; }
      100% { transform: translate(-50%, -85%) scale(1.35); opacity: 0; }
    }
  </style>
</head>

<body>
  <div class="fall-layer" id="fallLayer"></div>
  <div class="soft-glow"></div>

  <div class="toast" id="toast"></div>

  <!-- GAME SCREEN -->
  <div id="game-screen" class="card">
    <h1>üçÖ Tomato Catch: Level ‚ÄúCrush‚Äù</h1>
    <p class="sub">
      Quick mission: <b>tap/click 10 tomatoes</b> to unlock a very important question üò≥<br>
      üéÅ = bonus points, üéÑ = ‚Äúnice try‚Äù (tiny penalty)
    </p>

    <div class="gif-container">
      <img src="https://media.tenor.com/I7KdFaOqqlcAAAAi/milk-and-mocha-bear-couple.gif" alt="Cute bear">
    </div>

    <div class="hud">
      <div class="pill">üçÖ Tomatoes: <span id="tomatoCount">0</span>/10</div>
      <div class="pill">‚ú® Score: <span id="score">0</span></div>
    </div>

    <div class="buttons">
      <button class="primary" id="startBtn" onclick="startGame()">Start</button>
      <button class="ghost" onclick="skipGame()">Skip (only if you're evil)</button>
    </div>
  </div>

  <!-- QUESTION SCREEN -->
  <div id="question-screen" class="card">
    <h1>Will you be my girlfriend? ü•∫</h1>
    <p class="sub">You already passed the tomato test‚Ä¶ so basically you HAVE to say yes.</p>

    <div class="gif-container">
      <img src="https://media.tenor.com/I7KdFaOqqlcAAAAi/milk-and-mocha-bear-couple.gif" alt="Cute pleading bear">
    </div>

    <div class="buttons">
      <button id="yes-btn" onclick="sayYes()">Yes!</button>
      <button id="no-btn" onclick="sayNo()">No</button>
    </div>
  </div>

  <!-- SUCCESS SCREEN -->
  <div id="success-screen" class="card">
    <h1>YAYYYY üò≠‚ù§Ô∏èüçÖ</h1>
    <p class="sub">Officially the cutest person alive. I owe you unlimited tomatoes.</p>

    <div class="gif-container">
      <img src="https://media.tenor.com/gUiu1zyxfzYAAAAi/bear-kiss-bear-kisses.gif" alt="Cute hugging bear">
    </div>

    <div class="buttons">
      <button class="primary" onclick="confettiMode()">More chaos üçÖüéÑüéÅ</button>
    </div>
  </div>

  <script>
    // ---------- Small helpers ----------
    const fallLayer = document.getElementById("fallLayer");
    const toast = document.getElementById("toast");

    function showToast(msg, ms = 1200) {
      toast.textContent = msg;
      toast.classList.add("show");
      clearTimeout(showToast._t);
      showToast._t = setTimeout(() => toast.classList.remove("show"), ms);
    }

    function heartPop(x, y) {
      const el = document.createElement("div");
      el.className = "heart-pop";
      el.textContent = "üíñ";
      el.style.left = x + "px";
      el.style.top = y + "px";
      el.style.fontSize = (16 + Math.random() * 12) + "px";
      document.body.appendChild(el);
      setTimeout(() => el.remove(), 700);
    }

    // ---------- Game state ----------
    let gameRunning = false;
    let tomatoesCaught = 0;
    let score = 0;
    let spawner = null;

    const tomatoCountEl = document.getElementById("tomatoCount");
    const scoreEl = document.getElementById("score");
    const startBtn = document.getElementById("startBtn");

    // Weighted drops (tomatoes more common)
    const dropTable = [
      { char: "üçÖ", type: "tomato", weight: 8, points: 2 },
      { char: "üçÖ", type: "tomato", weight: 8, points: 2 },
      { char: "üçÖ", type: "tomato", weight: 8, points: 2 },
      { char: "üéÅ", type: "gift",   weight: 3, points: 6 },
      { char: "üéÑ", type: "tree",   weight: 2, points: -2 },
      { char: "‚ú®", type: "spark",  weight: 1, points: 3 },
    ];

    function pickWeighted(arr) {
      const total = arr.reduce((s, x) => s + x.weight, 0);
      let r = Math.random() * total;
      for (const x of arr) {
        r -= x.weight;
        if (r <= 0) return x;
      }
      return arr[arr.length - 1];
    }

    function updateHUD() {
      tomatoCountEl.textContent = tomatoesCaught;
      scoreEl.textContent = score;
    }

    function startGame() {
      if (gameRunning) return;
      gameRunning = true;
      startBtn.textContent = "Running‚Ä¶";
      startBtn.disabled = true;
      showToast("Catch 10 tomatoes to unlock the question üçÖüò≥");

      spawner = setInterval(spawnDrop, 340);
      for (let i = 0; i < 10; i++) spawnDrop();
    }

    function endGameWin() {
      gameRunning = false;
      clearInterval(spawner);
      spawner = null;
      showToast("Tomato mission complete ‚úÖ Unlocking‚Ä¶", 1500);

      fallLayer.querySelectorAll(".click-item").forEach(el => el.remove());

      setTimeout(() => {
        document.getElementById("game-screen").style.display = "none";
        document.getElementById("question-screen").style.display = "block";
      }, 900);
    }

    function skipGame() {
      showToast("Skipping‚Ä¶ wow‚Ä¶ okay‚Ä¶ üò≠", 1200);
      document.getElementById("game-screen").style.display = "none";
      document.getElementById("question-screen").style.display = "block";
    }

    function spawnDrop() {
      const obj = gameRunning ? pickWeighted(dropTable) : { char: "üçÖ", type: "bg", points: 0 };
      const el = document.createElement("div");
      el.className = "click-item";
      el.textContent = obj.char;

      const left = Math.random() * 100;              // vw
      const size = 18 + Math.random() * 28;          // px
      const durFall = 3.6 + Math.random() * 2.6;     // seconds
      const durSway = 1.8 + Math.random() * 2.2;     // seconds
      const delay = -(Math.random() * 0.6);

      el.style.left = left + "vw";
      el.style.fontSize = size + "px";
      el.style.opacity = (0.35 + Math.random() * 0.55).toFixed(2);
      el.style.animationDuration = `${durFall}s, ${durSway}s`;
      el.style.animationDelay = `${delay}s, ${(-Math.random() * durSway).toFixed(2)}s`;

      if (gameRunning) {
        el.addEventListener("pointerdown", (e) => {
          e.preventDefault();

          score += obj.points;
          if (obj.type === "tomato") tomatoesCaught += 1;

          updateHUD();

          const x = e.clientX ?? (e.touches && e.touches[0]?.clientX) ?? (window.innerWidth / 2);
          const y = e.clientY ?? (e.touches && e.touches[0]?.clientY) ?? (window.innerHeight / 2);
          heartPop(x, y);

          if (obj.type === "tomato") showToast("+2 üçÖ nice!", 650);
          if (obj.type === "gift") showToast("+6 üéÅ romantic bonus!", 650);
          if (obj.type === "tree") showToast("-2 üéÑ nice try lol", 650);

          el.remove();

          if (tomatoesCaught >= 10) endGameWin();
        }, { passive: false });
      }

      fallLayer.appendChild(el);

      setTimeout(() => {
        if (el.parentNode) el.remove();
      }, (durFall + 0.7) * 1000);
    }

    // Background vibe before start
    setInterval(() => { if (!gameRunning) spawnDrop(); }, 600);

    // ---------- YES/NO logic ----------
    let noClickCount = 0;
    const noTexts = [
      "No",
      "Are you sure? üò¢",
      "Really really sure?",
      "Think again! üò≠",
      "Don't do this to me!",
      "You're breaking my heart üíî",
      "I'm gonna cry...",
      "Okay, I'll stop asking... JK!",
      "PLEASE JUST CLICK YES!"
    ];

    function sayNo() {
      noClickCount++;

      const yesBtn = document.getElementById('yes-btn');
      const noBtn = document.getElementById('no-btn');

      const textIndex = Math.min(noClickCount, noTexts.length - 1);
      noBtn.innerText = noTexts[textIndex];

      const currentYesSize = parseFloat(window.getComputedStyle(yesBtn).fontSize);
      const currentYesPad = parseFloat(window.getComputedStyle(yesBtn).paddingTop);
      yesBtn.style.fontSize = (currentYesSize * 1.35) + 'px';
      yesBtn.style.padding = (currentYesPad * 1.25) + 'px ' + (currentYesPad * 2.5) + 'px';

      const currentNoSize = parseFloat(window.getComputedStyle(noBtn).fontSize);
      noBtn.style.fontSize = (currentNoSize * 0.82) + 'px';

      if (noClickCount >= 5) noBtn.style.opacity = "0.75";
      if (noClickCount >= 8) noBtn.style.opacity = "0.55";

      showToast("The 'No' button is getting shy‚Ä¶ üò≠", 850);
    }

    function sayYes() {
      document.getElementById('question-screen').style.display = 'none';
      document.getElementById('success-screen').style.display = 'block';
      showToast("She said YES!!! üíñüíñüíñ", 1400);
    }

    function confettiMode() {
      showToast("Entering MAXIMUM TOMATO MODE üçÖüçÖüçÖ", 1200);
      for (let i = 0; i < 20; i++) spawnDrop();
    }
  </script>
</body>
</html>
